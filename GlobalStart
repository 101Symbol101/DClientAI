#Requires AutoHotKey v2.0
#SingleInstance Force

#Include "lib\WebServe.ahk"

if !DirExist(A_ScriptDir . "\www") {
    DirCreate(A_ScriptDir . "\www")
}

; html
htmlContent := "
(
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebServe</title>
</head>
<body>
    <h1>Hi</h1>
</body>
</html>
)"
FileOpen(A_ScriptDir . "\www\index.html", "w", "UTF-8").Write(htmlContent)
server := WebServe(8080, "127.0.0.1", A_ScriptDir . "\www")
server.AddRoute("/api/hello", (url, method) => '{"message": "hi", "timestamp": "' . A_Now . '"}')
server.Serve()
^q::server.Stop()
^r::Reload()
